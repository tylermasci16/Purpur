From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: tylermasci <mascityler@gmail.com>
Date: Thu, 9 Jun 2022 03:43:02 -0400
Subject: [PATCH] fix antimalware


diff --git a/src/main/java/com/gmail/mascityler/antimalware/AntiMalwareDriver.java b/src/main/java/com/gmail/mascityler/antimalware/AntiMalwareDriver.java
index baed4ae6fb0e0780f7bb6bff38879c20e773f6c2..a1a8b011bca4bbda425208d04670e7b8ffc0a970 100644
--- a/src/main/java/com/gmail/mascityler/antimalware/AntiMalwareDriver.java
+++ b/src/main/java/com/gmail/mascityler/antimalware/AntiMalwareDriver.java
@@ -23,13 +23,14 @@ public class AntiMalwareDriver {
     private static boolean istransformed=false;
 
     public static void trans() {
-        //if (inst != null && istransformed) {
-           //Transformers.a(() -> null);
+        if (inst != null && istransformed) {
+            //Transformers.a(() -> null);
 
-        CallerInfo callerInfo = RuntimeUtils.getCallerInfo();
-        if (callerInfo != null && AntiMalware.getInstance().getCheckManager().isPluginJarBlacklisted(callerInfo.getPlugin().getJar())) {
-            throw new FormattedSecurityException(I18n.tl("might_be_malicious", new Object[]{callerInfo.getPlugin().getJar()}));
+            CallerInfo callerInfo = RuntimeUtils.getCallerInfo();
+            if (callerInfo != null && AntiMalware.getInstance().getCheckManager().isPluginJarBlacklisted(callerInfo.getPlugin().getJar())) {
+                throw new FormattedSecurityException(I18n.tl("might_be_malicious", new Object[]{callerInfo.getPlugin().getJar()}));
             }
+        }
     }
 
 
